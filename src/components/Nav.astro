---
const links = [
  { href: '/',         label: 'Home' },
  { href: '/projects', label: 'Projects' },
  { href: '/blog',     label: 'Blog' },
  { href: '/about',    label: 'About' },
];

const path = Astro.url.pathname || '/';
const isActive = (href: string) =>
  href === '/' ? path === '/' : path.startsWith(href);

// å½“å‰è¯­è¨€ï¼ˆä»…ç”¨äºæ˜¾ç¤ºå’Œç”Ÿæˆé“¾æ¥ï¼‰
const p = path;
const currentLang =
  p.startsWith('/fi')  ? 'fi'  :
  p.startsWith('/sv')  ? 'sv'  :
  p.startsWith('/zh')  ? 'zh'  :
  p.startsWith('/yue') ? 'yue' : 'en';

const langHref = (code: string) => (code === 'en' ? '/' : `/${code}`);
const langLabel = (code: string) =>
  code === 'en' ? 'EN' : code === 'fi' ? 'FI' : code === 'sv' ? 'SV' : code === 'zh' ? 'ä¸­æ–‡' : 'ç²µèª';
---

<header class="sticky top-0 z-40 bg-white/80 backdrop-blur border-b border-zinc-200 dark:bg-zinc-900/80 dark:border-zinc-800">
  <div class="mx-auto max-w-7xl h-16 px-4 md:px-8 flex items-center gap-4">
    <!-- å“ç‰Œï¼šæ›´é‡çš„å­—å·/å­—é‡ -->
    <a href="/" class="shrink-0 font-extrabold tracking-tight text-[20px] md:text-[22px]">
      Xiaosi Huang
    </a>

    <!-- ç»†åˆ†éš”çº¿ï¼šæŠŠå“ç‰Œä¸èœå•æ˜ç¡®åˆ†åŒº -->
    <div class="hidden sm:block h-5 w-px bg-zinc-200 dark:bg-zinc-800"></div>

    <!-- ä¸»å¯¼èˆªï¼ˆæ¡Œé¢ï¼‰ -->
    <nav class="hidden sm:flex items-center gap-2 text-[15px] md:text-[16px] font-medium">
      {links.map((l) => (
        <a
          href={l.href}
          aria-current={isActive(l.href) ? 'page' : undefined}
          class={
            (isActive(l.href)
              ? 'text-zinc-900 dark:text-zinc-100 bg-zinc-100/80 dark:bg-zinc-800'
              : 'text-zinc-600 hover:text-zinc-900 dark:text-zinc-300 dark:hover:text-white hover:bg-zinc-100/60 dark:hover:bg-zinc-800/70'
            )
            + ' px-3 py-1.5 rounded-lg transition'
          }
        >
          {l.label}
        </a>
      ))}
    </nav>

    <!-- å³ä¾§å ä½ï¼ŒæŠŠè¯­è¨€æ¨åˆ°æœ€å³ -->
    <div class="ml-auto"></div>

    <!-- è¯­è¨€ï¼šæ¡Œé¢ä¸‹æ‹‰ -->
    <details class="relative hidden sm:block">
      <summary class="list-none cursor-pointer select-none rounded-md border border-zinc-300/70 dark:border-zinc-700 px-2 py-1.5 text-[14px] flex items-center gap-1">
        ğŸŒ {langLabel(currentLang)}
      </summary>
      <ul class="absolute right-0 mt-2 w-44 rounded-xl border border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-900 shadow-lg p-2 space-y-1 z-50">
        <li><a href={langHref('en')}  class="block rounded-md px-2 py-1 hover:bg-zinc-100 dark:hover:bg-zinc-800">ğŸ‡¬ğŸ‡§ English</a></li>
        <li><a href={langHref('fi')}  class="block rounded-md px-2 py-1 hover:bg-zinc-100 dark:hover:bg-zinc-800">ğŸ‡«ğŸ‡® Suomi</a></li>
        <li><a href={langHref('sv')}  class="block rounded-md px-2 py-1 hover:bg-zinc-100 dark:hover:bg-zinc-800">ğŸ‡¸ğŸ‡ª Svenska</a></li>
        <li><a href={langHref('zh')}  class="block rounded-md px-2 py-1 hover:bg-zinc-100 dark:hover:bg-zinc-800">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</a></li>
        <li><a href={langHref('yue')} class="block rounded-md px-2 py-1 hover:bg-zinc-100 dark:hover:bg-zinc-800">ğŸ‡­ğŸ‡° Cantonese</a></li>
      </ul>
    </details>

    <!-- ç§»åŠ¨ç«¯ï¼šæŠŠå¯¼èˆª & è¯­è¨€åˆå¹¶ä¸ºä¸€ä¸ªæŠ½å±‰ï¼Œä¿æŒæç®€ -->
    <details class="relative sm:hidden">
      <summary class="list-none cursor-pointer select-none rounded-md border border-zinc-300/70 dark:border-zinc-700 px-2 py-1.5 text-[14px]">
        Menu
      </summary>
      <div class="absolute right-0 mt-2 w-56 rounded-xl border border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-900 shadow-lg p-2 z-50">
        <div class="px-2 pb-2 text-[12px] uppercase tracking-wide opacity-60">Navigate</div>
        <nav class="flex flex-col gap-1 mb-2">
          {links.map((l) => (
            <a
              href={l.href}
              class={(isActive(l.href)
                ? 'bg-zinc-100/80 dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100'
                : 'hover:bg-zinc-100/60 dark:hover:bg-zinc-800/70 text-zinc-700 dark:text-zinc-300')
                + ' rounded-md px-3 py-2'}
            >
              {l.label}
            </a>
          ))}
        </nav>

        <div class="px-2 pt-1 pb-2 text-[12px] uppercase tracking-wide opacity-60">Language</div>
        <ul class="space-y-1">
          <li><a href={langHref('en')}  class="block rounded-md px-3 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-800">ğŸ‡¬ğŸ‡§ English</a></li>
          <li><a href={langHref('fi')}  class="block rounded-md px-3 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-800">ğŸ‡«ğŸ‡® Suomi</a></li>
          <li><a href={langHref('sv')}  class="block rounded-md px-3 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-800">ğŸ‡¸ğŸ‡ª Svenska</a></li>
          <li><a href={langHref('zh')}  class="block rounded-md px-3 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-800">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</a></li>
          <li><a href={langHref('yue')} class="block rounded-md px-3 py-2 hover:bg-zinc-100 dark:hover:bg-zinc-800">ğŸ‡­ğŸ‡° Cantonese</a></li>
        </ul>
      </div>
    </details>
  </div>
</header>
