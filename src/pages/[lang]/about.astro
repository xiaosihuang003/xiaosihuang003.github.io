---
/* @ts-nocheck */
import Layout from "../../layouts/Layout.astro";
import { dict, normalizeLang, languages } from "../../i18n";

export const prerender = true;
export function getStaticPaths() {
  return (languages as readonly string[]).map((lang) => ({ params: { lang } }));
}

const lang = normalizeLang(Astro.params.lang as string);
const t = dict[lang];

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   â‘  ç…§ç‰‡å¢™æ•°æ®ï¼šé™æ€å¯¼å…¥ JSON
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
import CAPS_EN from "../../data/albums.en.json";
import CAPS_ZH from "../../data/albums.zh.json";
import CAPS_YUE from "../../data/albums.yue.json";
import CAPS_FI from "../../data/albums.fi.json";
import CAPS_NO from "../../data/albums.no.json";
import CAPS_SV from "../../data/albums.sv.json";

type SeasonKey = "Spring" | "Summer" | "Autumn" | "Winter";
type YearCaps = Partial<Record<SeasonKey, string>> & { Highlights?: string[] };
type Caps = Record<string, YearCaps>;

const BY_LANG: Record<string, Caps> = {
  en: CAPS_EN as Caps,
  zh: CAPS_ZH as Caps,
  yue: CAPS_YUE as Caps,
  fi: CAPS_FI as Caps,
  no: CAPS_NO as Caps,
  sv: CAPS_SV as Caps,
};
const CAPS: Caps = BY_LANG[lang] ?? (CAPS_EN as Caps);

const years = Array.from(new Set([
  ...Object.keys(CAPS_EN as Caps),
  ...Object.keys(CAPS),
]))
  .map((y) => Number(y))
  .sort((a, b) => b - a);

const captionOf = (year: number, s: SeasonKey) =>
  CAPS[String(year)]?.[s] ??
  (CAPS_EN as Caps)[String(year)]?.[s] ??
  "";

const highlightsOf = (year: number): string[] =>
  (CAPS[String(year)]?.Highlights ??
   (CAPS_EN as Caps)[String(year)]?.Highlights ??
   []) as string[];

const seasonLabelMap: Record<string, Record<SeasonKey, string>> = {
  en: { Spring: "Spring", Summer: "Summer", Autumn: "Autumn", Winter: "Winter" },
  zh: { Spring: "æ˜¥", Summer: "å¤", Autumn: "ç§‹", Winter: "å†¬" },
  yue:{ Spring: "æ˜¥", Summer: "å¤", Autumn: "ç§‹", Winter: "å†¬" },
  fi: { Spring: "KevÃ¤t", Summer: "KesÃ¤", Autumn: "Syksy", Winter: "Talvi" },
  no: { Spring: "VÃ¥r", Summer: "Sommer", Autumn: "HÃ¸st", Winter: "Vinter" },
  sv: { Spring: "VÃ¥r", Summer: "Sommar", Autumn: "HÃ¶st", Winter: "Vinter" },
};
const S = seasonLabelMap[lang] ?? seasonLabelMap.en;
const ORDER: SeasonKey[] = ["Spring", "Summer", "Autumn", "Winter"];

const HIGHLIGHTS_LABEL: Record<string, string> = {
  en: "Highlights",
  zh: "å¹´åº¦é«˜å…‰",
  yue: "å¹´åº¦é«˜å…‰",
  fi: "Kohokohdat",
  no: "HÃ¸ydepunkter",
  sv: "HÃ¶jdpunkter",
};
const HLabel = HIGHLIGHTS_LABEL[lang] ?? HIGHLIGHTS_LABEL.en;

const pad3 = (n: number) => String(n).padStart(3, "0");

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   â‘¡ å…¶ä½™æ•°æ®ï¼ˆå¤´åƒ/é“¾æ¥/æ•™è‚²/è¯­è¨€/å›½å®¶/æŠ€èƒ½ï¼‰
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const avatar = "/images/about/avatar.jpg";

const links: Array<{ label: string; href: string; sub?: string; ext?: boolean }> = [
  { label: "GitHub",                 href: "https://github.com/xiaosihuang003", ext: true },
  { label: "LinkedIn",               href: "https://www.linkedin.com/in/xiaosi-huang-387559251/", ext: true },
  { label: "Tableau Public",         href: "https://public.tableau.com/app/profile/xiaosi.huang/vizzes", ext: true },
  { label: "Resume & CV (Updating)", href: "/resume.pdf", ext: true },
  { label: "Email :",                href: "mailto:huang.xiaosi@outlook.com", sub: "huang.xiaosi@outlook.com" },
];

const thesisUrl = "https://www.theseus.fi/handle/10024/885903";
type Edu = { title: string; school: string; period: string; gpa?: string; thesis?: { label: string; href: string } };
const education: Edu[] = [
  { title: "M.Sc. in Data Science (ongoing)", school: "Tampere University", period: "Aug 2025 â€“ present" },
  { title: "B.Eng. in Software Engineering",  school: "Tampere University of Applied Sciences", period: "Aug 2021 â€“ May 2025", gpa: "GPA: 4.63 / 5", thesis: { label: "Bachelor's Thesis", href: thesisUrl } },
];

const profileByLang: Record<string, { speak: string[]; studied: string[] }> = {
  en:  { speak: ["English", "Cantonese", "Mandarin"],               studied: ["Japanese", "Finnish"] },
  zh:  { speak: ["è‹±è¯­", "ç²¤è¯­", "æ™®é€šè¯"],                           studied: ["æ—¥è¯­", "èŠ¬å…°è¯­"] },
  yue: { speak: ["è‹±èª", "å»£æ±è©±", "æ™®é€šè©±"],                         studied: ["æ—¥æ–‡", "èŠ¬è˜­æ–‡"] },
  fi:  { speak: ["englanti", "kantoninkiina", "mandariinikiina"],   studied: ["japani", "suomi"] },
  no:  { speak: ["engelsk", "kantonesisk", "mandarin"],             studied: ["japansk", "finsk"] },
  sv:  { speak: ["engelska", "kantonesiska", "mandarin"],           studied: ["japanska", "finska"] },
};
const langData = profileByLang[lang] ?? profileByLang.en;

const VISITED = [
  "FR","JP","RU","TR","FI","LV","NO","HU","AT","LT",
  "IT","CZ","SK","BE","EE","SE","ES","PT","CH","DE",
  "DK","RO","GR","HR","SI",
] as const;

type CC = typeof VISITED[number];

const flags: Record<CC, string> = {
  FR:"ğŸ‡«ğŸ‡·", JP:"ğŸ‡¯ğŸ‡µ", RU:"ğŸ‡·ğŸ‡º", TR:"ğŸ‡¹ğŸ‡·", FI:"ğŸ‡«ğŸ‡®", LV:"ğŸ‡±ğŸ‡»", NO:"ğŸ‡³ğŸ‡´",
  HU:"ğŸ‡­ğŸ‡º", AT:"ğŸ‡¦ğŸ‡¹", LT:"ğŸ‡±ğŸ‡¹", IT:"ğŸ‡®ğŸ‡¹", CZ:"ğŸ‡¨ğŸ‡¿", SK:"ğŸ‡¸ğŸ‡°", BE:"ğŸ‡§ğŸ‡ª",
  EE:"ğŸ‡ªğŸ‡ª", SE:"ğŸ‡¸ğŸ‡ª", ES:"ğŸ‡ªğŸ‡¸", PT:"ğŸ‡µğŸ‡¹", CH:"ğŸ‡¨ğŸ‡­", DE:"ğŸ‡©ğŸ‡ª", DK:"ğŸ‡©ğŸ‡°",
  RO:"ğŸ‡·ğŸ‡´", GR:"ğŸ‡¬ğŸ‡·", HR:"ğŸ‡­ğŸ‡·", SI:"ğŸ‡¸ğŸ‡®",
};

const countryNames: Record<string, Record<CC, string>> = {
  en: {
    FR:"France", JP:"Japan", RU:"Russia", TR:"Turkey", FI:"Finland", LV:"Latvia", NO:"Norway",
    HU:"Hungary", AT:"Austria", LT:"Lithuania", IT:"Italy", CZ:"Czechia", SK:"Slovakia",
    BE:"Belgium", EE:"Estonia", SE:"Sweden", ES:"Spain", PT:"Portugal", CH:"Switzerland",
    DE:"Germany", DK:"Denmark", RO:"Romania", GR:"Greece", HR:"Croatia", SI:"Slovenia",
  },
  zh: {
    FR:"æ³•å›½", JP:"æ—¥æœ¬", RU:"ä¿„ç½—æ–¯", TR:"åœŸè€³å…¶", FI:"èŠ¬å…°", LV:"æ‹‰è„±ç»´äºš", NO:"æŒªå¨",
    HU:"åŒˆç‰™åˆ©", AT:"å¥¥åœ°åˆ©", LT:"ç«‹é™¶å®›", IT:"æ„å¤§åˆ©", CZ:"æ·å…‹", SK:"æ–¯æ´›ä¼å…‹",
    BE:"æ¯”åˆ©æ—¶", EE:"çˆ±æ²™å°¼äºš", SE:"ç‘å…¸", ES:"è¥¿ç­ç‰™", PT:"è‘¡è„ç‰™", CH:"ç‘å£«",
    DE:"å¾·å›½", DK:"ä¸¹éº¦", RO:"ç½—é©¬å°¼äºš", GR:"å¸Œè…Š", HR:"å…‹ç½—åœ°äºš", SI:"æ–¯æ´›æ–‡å°¼äºš",
  },
  yue: {
    FR:"æ³•åœ‹", JP:"æ—¥æœ¬", RU:"ä¿„ç¾…æ–¯", TR:"åœŸè€³å…¶", FI:"èŠ¬è˜­", LV:"æ‹‰è„«ç¶­äº", NO:"æŒªå¨",
    HU:"åŒˆç‰™åˆ©", AT:"å¥§åœ°åˆ©", LT:"ç«‹é™¶å®›", IT:"æ„å¤§åˆ©", CZ:"æ·å…‹", SK:"æ–¯æ´›ä¼å…‹",
    BE:"æ¯”åˆ©æ™‚", EE:"æ„›æ²™å°¼äº", SE:"ç‘å…¸", ES:"è¥¿ç­ç‰™", PT:"è‘¡è„ç‰™", CH:"ç‘å£«",
    DE:"å¾·åœ‹", DK:"ä¸¹éº¥", RO:"ç¾…é¦¬å°¼äº", GR:"å¸Œè‡˜", HR:"å…‹ç¾…åœ°äº", SI:"æ–¯æ´›æ–‡å°¼äº",
  },
  fi: {
    FR:"Ranska", JP:"Japani", RU:"VenÃ¤jÃ¤", TR:"Turkki", FI:"Suomi", LV:"Latvia", NO:"Norja",
    HU:"Unkari", AT:"ItÃ¤valta", LT:"Liettua", IT:"Italia", CZ:"TÅ¡ekki", SK:"Slovakia",
    BE:"Belgia", EE:"Viro", SE:"Ruotsi", ES:"Espanja", PT:"Portugali", CH:"Sveitsi",
    DE:"Saksa", DK:"Tanska", RO:"Romania", GR:"Kreikka", HR:"Kroatia", SI:"Slovenia",
  },
  no: {
    FR:"Frankrike", JP:"Japan", RU:"Russland", TR:"Tyrkia", FI:"Finland", LV:"Latvia", NO:"Norge",
    HU:"Ungarn", AT:"Ã˜sterrike", LT:"Litauen", IT:"Italia", CZ:"Tsjekkia", SK:"Slovakia",
    BE:"Belgia", EE:"Estland", SE:"Sverige", ES:"Spania", PT:"Portugal", CH:"Sveits",
    DE:"Tyskland", DK:"Danmark", RO:"Romania", GR:"Hellas", HR:"Kroatia", SI:"Slovenia",
  },
  sv: {
    FR:"Frankrike", JP:"Japan", RU:"Ryssland", TR:"Turkiet", FI:"Finland", LV:"Lettland", NO:"Norge",
    HU:"Ungern", AT:"Ã–sterrike", LT:"Litauen", IT:"Italien", CZ:"Tjeckien", SK:"Slovakien",
    BE:"Belgien", EE:"Estland", SE:"Sverige", ES:"Spanien", PT:"Portugal", CH:"Schweiz",
    DE:"Tyskland", DK:"Danmark", RO:"RumÃ¤nien", GR:"Grekland", HR:"Kroatien", SI:"Slovenien",
  },
};

const countries = VISITED.map((cc) => `${flags[cc]}${countryNames[lang]?.[cc] ?? countryNames.en[cc]}`);

// âœ… Power BI added, ETL removed
const skills = [
  "Python", "SQL", "PySpark",
  "Databricks", "Azure", "AWS",
  "Data Visualization", "Tableau", "Power BI", "Dashboard Design",
  "Pandas", "Statistics", "Machine Learning",
  "Data Cleaning", "Storytelling",
];

const goodAtTitle: string = (t as any)?.about?.goodAtTitle ?? "What I am good at?";
---

<Layout lang={lang} title={`Xiaosi Huang Â· ${t.about.title}`}>
  <section id="about" class="mx-auto max-w-5xl px-4">
    <h1 class="text-4xl font-extrabold mb-1">{t.about.title}</h1>
    {t.about.subtitle && <p class="text-zinc-600 dark:text-zinc-300 mb-5">{t.about.subtitle}</p>}

    <!-- é¡¶éƒ¨ï¼šå¤´åƒ / Links / æ•™è‚² / æŠ€èƒ½ -->
    <section class="card card--tight">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 items-stretch">
        <figure class="rounded-2xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900/70 p-4 overflow-hidden self-start md:self-stretch md:row-span-2 max-w-[240px] w-full">
          <div class="aspect-[4/5] w-full overflow-hidden rounded-xl">
            <img src={avatar} alt="Portrait" class="w-full h-full object-cover" style="object-position:center 22%;" loading="eager" onerror="this.src='/placeholder.jpg'" />
          </div>
        </figure>

        <div class="self-start">
          <h2 class="col-title">{t.about.links}</h2>
          <ul class="space-y-2">
            {links.map((l) => (
              <li class="pl-4 relative leading-tight">
                <span class="dot" aria-hidden="true"></span>
                <div class="link-row">
                  <a href={l.href} target={l.ext ? "_blank" : undefined} rel={l.ext ? "noopener noreferrer" : undefined} class="link font-medium text-[15px]">
                    {l.label}{l.ext ? " â†—" : ""}
                  </a>
                  {l.sub && <span class="sub sub-lg sub-inline text-zinc-600">{l.sub}</span>}
                </div>
              </li>
            ))}
          </ul>
        </div>

        <div class="self-start">
          <h2 class="col-title">{t.about.education}</h2>
          <ul class="space-y-2">
            {education.map((e) => (
              <li class="pl-4 relative leading-tight">
                <span class="dot" aria-hidden="true"></span>
                <div class="font-semibold text-[15px]">{e.title}</div>
                <div class="sub sub-lg text-zinc-600">{e.school}</div>
                <div class="sub sub-lg text-zinc-500">{e.period}</div>
                {e.gpa && <div class="sub sub-lg text-zinc-600">{e.gpa}</div>}
                {e.thesis && (
                  <div class="mt-0.5">
                    <a href={e.thesis.href} target="_blank" rel="noopener noreferrer" class="text-[16px] md:text-[17px] font-semibold text-red-600 hover:text-red-700">
                      {e.thesis.label} â†—
                    </a>
                  </div>
                )}
              </li>
            ))}
          </ul>
        </div>

        <div class="md:col-span-2 md:col-start-2">
          <h2 class="col-title">{goodAtTitle}</h2>
          <div class="chips-wrap">
            {skills.map((s) => <span class="pill">{s}</span>)}
          </div>
        </div>
      </div>
    </section>

    <!-- è¯­è¨€ & å›½å®¶ -->
    <section class="card mt-5">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-start">
        <div class="md:col-span-1">
          <h2 class="sec-title">{t.about.languages}</h2>

          <!-- I speak -->
          <div class="lang-row">
            <span class="lang-label">{t.about.speak}</span>
            <div class="lang-chips">
              {langData.speak.map((x) => <span class="pill">{x}</span>)}
            </div>
          </div>

          <!-- I have learned -->
          <div class="lang-row">
            <span class="lang-label">{t.about.studied}</span>
            <div class="lang-chips">
              {langData.studied.map((x) => <span class="pill">{x}</span>)}
            </div>
          </div>

          <!-- Hobbies -->
          <h2 class="sec-title mt-3">{t.about.hobbies}</h2>
          <div class="chips-wrap">
            {t.about.hobbyList.map((h) => <span class="pill">{h}</span>)}
          </div>
        </div>

        <div class="md:col-span-2">
          <h2 class="sec-title flex items-baseline gap-2">
            {t.about.countriesVisited} <span class="count">({countries.length})</span>
          </h2>
          <div class="chips-wrap">{countries.map((c) => <span class="pill">{c}</span>)}</div>
        </div>
      </div>
    </section>

    <!-- ç…§ç‰‡å¢™ -->
    <section class="mt-4">
      <h2 class="text-xl font-semibold">{t.about.fourSeasonsTitle}</h2>
      <p class="text-zinc-600 dark:text-zinc-300 mb-3 text-[15px]">{t.about.fourSeasonsSubtitle}</p>

      {years.map((year) => {
        const H = highlightsOf(year);
        return (
          <div class="mb-6">
            <h3 class="text-lg font-semibold mb-2">
              {year} Â· {S.Spring} â€¢ {S.Summer} â€¢ {S.Autumn} â€¢ {S.Winter}
            </h3>

            {H.length > 0 && (
              <div class="mb-3">
                <div class="text-[15px] font-semibold mb-2">{HLabel}</div>
                <div class="masonry">
                  {H.map((cap, idx) => (
                    <figure class="masonry-item rounded-2xl border border-zinc-200 dark:border-zinc-800 bg-white/90 dark:bg-zinc-900/60 overflow-hidden">
                      <img
                        src={`/images/about/${year}/Highlights/${pad3(idx + 1)}.jpg`}
                        alt={`${year} Highlights ${idx + 1}`}
                        class="w-full h-auto object-contain"
                        loading="lazy"
                        onerror="this.src='/placeholder.jpg'"
                      />
                      {(cap ?? "").trim() && (
                        <figcaption class="p-2.5">
                          <div class="text-[13px] text-zinc-600 dark:text-zinc-300">{cap}</div>
                        </figcaption>
                      )}
                    </figure>
                  ))}
                </div>
              </div>
            )}

            <div class="masonry">
              {ORDER.map((s) => (
                <figure class="masonry-item rounded-2xl border border-zinc-200 dark:border-zinc-800 bg-white/90 dark:bg-zinc-900/60 overflow-hidden">
                  <img
                    src={`/images/about/${year}/${s}.jpg`}
                    alt={`${year} ${s}`}
                    class="w-full h-auto object-contain"
                    loading="lazy"
                    onerror="this.src='/placeholder.jpg'"
                  />
                  <figcaption class="p-2.5">
                    <div class="font-medium text-[15px]">{year} Â· {S[s]}</div>
                    {captionOf(year, s) && (
                      <div class="text-[13px] text-zinc-600 dark:text-zinc-300 mt-0.5">
                        {captionOf(year, s)}
                      </div>
                    )}
                  </figcaption>
                </figure>
              ))}
            </div>
          </div>
        );
      })}
    </section>
  </section>

  <style>
    #about .card{ border:1px solid var(--border); border-radius:16px; background:color-mix(in oklab, white 92%, transparent); padding:0.5rem 0.75rem; }
    @media (min-width:768px){ #about .card{ padding:0.75rem 1rem; } }
    #about .card--tight{ padding:0.6rem 0.9rem; }

    #about .dot{ position:absolute; left:0; top:.42rem; width:.42rem; height:.42rem; border-radius:9999px; background:#15803d; }
    #about .col-title{ font-size:1rem; font-weight:700; margin-bottom:.3rem; }
    #about .link{ text-decoration:none; border-bottom:1px solid transparent; }
    #about .link:hover{ text-decoration:underline; }

    #about .link-row{ display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; }
    #about .sub{ font-size:13.5px; color:var(--muted); }
    #about .sub-lg{ font-size:14.5px; }
    #about .sub-inline{ display:inline; line-height:1.2; }

    #about .sec-title{ font-size:1rem; font-weight:700; margin-bottom:.35rem; }
    #about .count{ font-size:12.5px; color:var(--subtle); }

    #about .lang-row{
      display: grid;
      grid-template-columns: auto 1fr;
      gap: .4rem;
      align-items: start;
      margin-bottom: .3rem;
    }
    #about .lang-label{
      font-size: 14.5px;
      color: var(--muted);
      line-height: 1.6;
      white-space: nowrap;
      padding-top: .1rem;
    }
    #about .lang-chips{
      display: flex;
      flex-wrap: wrap;
      gap: .24rem .32rem;
    }

    #about .chips-wrap{ display:flex; flex-wrap:wrap; gap:.24rem .32rem; }
    #about .pill{ display:inline-block; padding:.16rem .42rem; font-size:.76rem; line-height:1; border-radius:9999px; background:var(--tag-bg); color:var(--tag-text); border:1px solid var(--border); }

    /* Masonry */
    #about .masonry{ column-count:1; column-gap:.875rem; }
    @media (min-width:640px){ #about .masonry{ column-count:2; } }
    @media (min-width:1024px){ #about .masonry{ column-count:4; } }
    #about .masonry-item{ break-inside:avoid; margin-bottom:.875rem; }
  </style>
</Layout>